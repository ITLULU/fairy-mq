# fairy-MQ
MQ消息中间件


## 使用mq解决的一个解耦 秒杀服务
mq 生产者发送下单信息，不同机器（集群） 去消费这些消息

## rabbitmq的集群
rabbitmq的普通集群之后将共享队列，交换机这些信息，如果一个请求请求到的集群中的某一台机器，但是该机器上并没有该消息，就会从
其他机器临时将该消息同步过来（erlang集群），效率低，且存在消息不一致（如果某一个节点宕机），（haproxy只会进行请求转发，如果机器宕机是无法保证数据一致的）


使用docker镜像集群
请求到任何节点都会得到数据，有一定的低延迟，可以保证一致性。（5-7个节点已经很大的数据量了），对于rabbitmq集群不需要考虑搭建集群的偶数
奇数台问题，因为不需要考虑（raft协议）因为不同集群的数据是一样的

企业搭建

`//这些队列都是 classic
channel.queueDeclare(RabbitConstant.QUEUE_WorkQueue, true, false, false, null);
`


## rocketMq
并发多线程消费消息的时候加锁，一个队列一个队列的消费